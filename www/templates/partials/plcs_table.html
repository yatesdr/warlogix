{{define "plcs_table.html"}}
<table class="table">
    <thead>
        <tr>
            <th>Name</th>
            <th>Address</th>
            <th>Family</th>
            <th>Product</th>
            <th>Tags</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {{range .PLCs}}
        <tr class="plc-row"
            data-name="{{.Name}}"
            data-address="{{.Address}}"
            data-slot="{{.Slot}}"
            data-family="{{.Family}}"
            data-status="{{.Status}}"
            data-status-class="{{.StatusClass}}"
            data-enabled="{{.Enabled}}"
            data-product="{{.ProductName}}"
            data-serial="{{.SerialNumber}}"
            data-vendor="{{.Vendor}}"
            data-tags="{{.TagCount}}"
            data-poll-rate="{{.PollRate}}"
            data-error="{{.Error}}"
            data-ams-net-id="{{.AmsNetId}}"
            data-ams-port="{{.AmsPort}}"
            data-protocol="{{.Protocol}}"
            data-fins-port="{{.FinsPort}}">
            <td>{{.Name}}</td>
            <td>{{.Address}}</td>
            <td>{{.Family}}</td>
            <td>{{.ProductName}}</td>
            <td>{{.TagCount}}</td>
            <td>
                {{if $.IsAdmin}}
                <button class="status-indicator {{.StatusClass}}"
                        onclick="toggleConnection('{{.Name}}')"
                        title="{{if eq .Status "Connected"}}Click to disconnect{{else if eq .Status "Disconnected"}}Click to connect{{else}}{{.Status}}{{end}}"
                        {{if and (ne .Status "Connected") (ne .Status "Disconnected")}}disabled{{end}}>
                    {{.Status}}
                </button>
                {{else}}
                <span class="status-badge {{.StatusClass}}">{{.Status}}</span>
                {{end}}
            </td>
            <td class="actions">
                <button class="btn-icon" title="Info" onclick="showInfoFromRow(this)">
                    <svg width="16" height="16" viewBox="0 0 16 16">
                        <circle cx="8" cy="8" r="6.5" fill="none" stroke="currentColor" stroke-width="1.5"/>
                        <text x="8" y="11.5" text-anchor="middle" font-size="9" font-weight="bold" fill="currentColor">i</text>
                    </svg>
                </button>
                {{if $.IsAdmin}}
                <button class="btn-icon" title="Settings" onclick="showEditModal('{{.Name}}')">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 10a2 2 0 100-4 2 2 0 000 4z"/>
                        <path fill-rule="evenodd" d="M6.5 1a.5.5 0 00-.5.5v1.02a5.5 5.5 0 00-1.5.62l-.72-.72a.5.5 0 00-.71 0l-.71.71a.5.5 0 000 .71l.72.72a5.5 5.5 0 00-.62 1.5H1.5a.5.5 0 00-.5.5v1a.5.5 0 00.5.5h1.02a5.5 5.5 0 00.62 1.5l-.72.72a.5.5 0 000 .71l.71.71a.5.5 0 00.71 0l.72-.72a5.5 5.5 0 001.5.62v1.02a.5.5 0 00.5.5h1a.5.5 0 00.5-.5v-1.02a5.5 5.5 0 001.5-.62l.72.72a.5.5 0 00.71 0l.71-.71a.5.5 0 000-.71l-.72-.72a5.5 5.5 0 00.62-1.5h1.02a.5.5 0 00.5-.5v-1a.5.5 0 00-.5-.5h-1.02a5.5 5.5 0 00-.62-1.5l.72-.72a.5.5 0 000-.71l-.71-.71a.5.5 0 00-.71 0l-.72.72a5.5 5.5 0 00-1.5-.62V1.5a.5.5 0 00-.5-.5h-1zM8 11a3 3 0 100-6 3 3 0 000 6z"/>
                    </svg>
                </button>
                <button class="btn-icon btn-icon-danger" title="Delete" onclick="deletePLC('{{.Name}}')">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M5.5 5.5v6M8 5.5v6M10.5 5.5v6"/>
                        <path d="M3 4h10l-.75 9.25a1 1 0 01-1 .75H4.75a1 1 0 01-1-.75L3 4z" fill="none" stroke="currentColor" stroke-width="1.25"/>
                        <path d="M5.5 4V2.5a.5.5 0 01.5-.5h4a.5.5 0 01.5.5V4" fill="none" stroke="currentColor" stroke-width="1.25"/>
                        <path d="M2 4h12" stroke="currentColor" stroke-width="1.25"/>
                    </svg>
                </button>
                {{end}}
            </td>
        </tr>
        {{if .Error}}
        <tr class="error-row">
            <td colspan="7" class="error-cell">{{.Error}}</td>
        </tr>
        {{end}}
        {{else}}
        <tr>
            <td colspan="7" class="empty-cell">No PLCs configured</td>
        </tr>
        {{end}}
    </tbody>
</table>
{{end}}
